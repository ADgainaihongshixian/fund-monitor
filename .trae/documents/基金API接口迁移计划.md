# 基金API接口迁移计划

## 1. 分析当前实现

当前`api.ts`文件使用本地mock数据模拟API响应，包含三个主要方法：
- `getFundData`：获取基金实时估值数据
- `searchFund`：搜索基金
- `getFundHistory`：获取基金历史数据

数据结构已在`types/index.ts`中定义，状态管理在`fundStore.ts`中实现。

## 2. 迁移计划

### 2.1 API接口选择
选择一个可靠的基金数据API服务，例如：
- 天天基金网API
- 新浪基金API
- 其他公开的基金数据接口

### 2.2 具体修改步骤

#### 步骤1：更新API基础配置
- 修改`BASE_URL`为实际API地址
- 根据API文档配置必要的请求头和参数

#### 步骤2：重构`getFundData`方法
- 调用实际API获取基金实时估值
- 处理API响应，确保数据结构与`FundData`类型兼容
- 增强错误处理机制

#### 步骤3：重构`searchFund`方法
- 调用实际API搜索基金
- 处理API响应，确保数据结构与`FundSearchResult`类型兼容
- 增强错误处理机制

#### 步骤4：重构`getFundHistory`方法
- 调用实际API获取基金历史数据
- 处理API响应，确保数据结构与`FundHistoryData`类型兼容
- 增强错误处理机制

#### 步骤5：优化错误处理
- 添加详细的错误类型判断
- 实现网络错误、超时错误等异常处理
- 确保错误信息清晰可读

#### 步骤6：测试验证
- 运行开发服务器，测试数据获取功能
- 验证界面显示正常
- 测试搜索和历史数据功能
- 测试错误处理机制

## 3. 技术要点

### 3.1 数据结构兼容性
- 确保API返回的数据可以正确映射到现有类型定义
- 处理可能的字段缺失情况

### 3.2 性能优化
- 保持现有的缓存机制
- 合理设置请求超时
- 实现请求防抖，避免频繁API调用

### 3.3 可靠性保障
- 实现重试机制，提高API调用成功率
- 添加网络状态检测
- 确保在API不可用时提供合理的错误提示

## 4. 预期结果

- 成功从实际API接口获取基金数据
- 界面显示正常，功能完整
- 错误处理机制完善
- 与现有代码结构无缝集成